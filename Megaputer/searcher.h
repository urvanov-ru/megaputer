

#ifndef _INCLUDE_SEARCHER_SAERFBLIWRG
#define _INCLUDE_SEARCHER_SAERFBLIWRG


class Searcher
{
public:
	////////////////////////////////////////////////////////////////////////////
	// Конструктор по-умолчанию. Начальная инициализация переменных.
	////////////////////////////////////////////////////////////////////////////
	Searcher();

	////////////////////////////////////////////////////////////////////////////
	//Деструктор. Очистка данных
	////////////////////////////////////////////////////////////////////////////
	~Searcher();

	////////////////////////////////////////////////////////////////////////////
	// Открывает текстовый файл fileName для поиска. По завершении работы с 
	// файлом нужно вызвать метод Close().
	////////////////////////////////////////////////////////////////////////////
	errno_t Open(LPCTSTR fileName);

	////////////////////////////////////////////////////////////////////////////
	// Закрывает открытый текстовый файл.
	////////////////////////////////////////////////////////////////////////////
	errno_t Close();

	////////////////////////////////////////////////////////////////////////////
	// Устанавливает фильтр и подготавливает внутренние структуры к поиску.
	// filter - строка фильтра. Можно использовать символы *(любые символы)
	// и ?(один любой символ). Возвращает 0 в случае успешного выполнения.
	////////////////////////////////////////////////////////////////////////////
	errno_t SetFilter(LPCTSTR filter);

	////////////////////////////////////////////////////////////////////////////
	// Возвращает следующую найденную строку, или NULL если достигнут конец
	// файла. Файл должен быть предварительно открыт методом Open. И должен
	// быть установлен фильтр командой SetFilter.
	////////////////////////////////////////////////////////////////////////////
	LPCTSTR GetNextLine();



private:
	FILE* file;
	LPTSTR filter;
	size_t filterLength;
	size_t* wordsSize;
	LPTSTR* words;
	size_t wordsCount;
	_TCHAR* buffer;
	size_t bufferSize;

	LPCTSTR ReadLine();
	bool IsMatch();
};


#endif